<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator</title>
    <link rel="stylesheet" href="./styles.css">
</head>
<body>
    <div id="display"></div>
    <div id="operatorPad">
        <button id="add">+</button>
        <button id="subtract">-</button>
        <button id="multiply">*</button>
        <button id="divide">/</button>
    </div>
    <div id="numPad">
        <button id="num1">1</button>
        <button id="num2">2</button>
        <button id="num3">3</button>
        <button id="num4">4</button>
        <button id="num5">5</button>
        <button id="num6">6</button>
        <button id="num7">7</button>
        <button id="num8">8</button>
        <button id="num9">9</button>
        <button id="equals">=</button>
        <button id="num0">0</button>
        <button id="clear">C</button>
    </div>

    <script>
        const display = document.querySelector("#display")
        const operatorPad = document.querySelector("#operatorPad")
        const numPad = document.querySelector("#numPad")

        let a = 0
        let b = 0
        let operator
        let operatorPressed = false
        let toClear = false
        let result

        // let operatorPressEvent = new customEvent("operatorPressed");

        operatorPad.addEventListener("click", (e) => {
            let displayText = document.querySelector("#display").textContent
            if (operatorPressed) {
                a = operate(a, operator, b)
                b = 0
            }
            if (displayText.includes("+") || displayText.includes("-") || displayText.includes("*") || displayText.includes("/")) return;
            switch (e.target.id) {
                case "add":
                    display.textContent += "+"
                    operator = "+"
                    break
                case "subtract":
                    display.textContent += "-"
                    operator = "-"
                    break
                case "multiply":
                    display.textContent += "*"
                    operator = "*"
                    break
                case "divide":
                    display.textContent += "/"
                    operator = "/"
                    break
            }
            if (e.target.id !== "numPad") {
                operatorPressed = true
                toClear = true
            }
        })


        numPad.addEventListener("click", (e) => {
            const displayText = display.textContent
            const idToDigit = {
                num0: "0",
                num1: "1",
                num2: "2",
                num3: "3",
                num4: "4",
                num5: "5",
                num6: "6",
                num7: "7",
                num8: "8",
                num9: "9",
                equals: "",
                clear: "",
            };
            const digit = idToDigit[e.target.id]

            if (e.target.id === "equals") {
                // if (!operator || b === 0) return;
                result = operate(a, operator, b)
                display.textContent = result
                a = result
                operator = ""
                b = 0
                console.log(`a: ${a} operator: ${operator} b: ${b}`)
            } else if (e.target.id === "clear") {
                a = 0
                b = 0
                operator = ""
                display.textContent = ""
                toClear = false
                operatorPressed = false
            }
            if (toClear) {
                display.textContent = ""
                toClear = false
            }
            if  (!operatorPressed) {
                a += digit
                console.log("a: " + a)
            } else {
                b += digit
                console.log("b: " + b)
            }
            if (digit) {
                display.textContent += digit
            }
        })

        // function add(...num) {
        //     for (let nums in num) {
        //         // ...add them together
        //     }
        // }
        function add(a, b) {
            return parseInt(a) + parseInt(b)
        }
        function subtract(a, b) {
            return parseInt(a) - parseInt(b)
        }
        function multiply(a, b) {
            return parseInt(a) * parseInt(b)
        }
        function divide(a, b) {
            return parseInt(a) / parseInt(b)
        }

        function operate(a, operator, b) {
            if (!b) {
                return a
            } else if (operator === "+") {
                return add(a, b)
            } else if (operator === "-") {
                return subtract(a, b)
            } else if (operator === "*") {
                return multiply(a, b)
            } else if (operator === "/") {
                return divide(a, b)
            } else {
                console.log("Invalid operator")
            }
        }
    </script>

</body>
</html>